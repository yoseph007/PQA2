"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{40223:function(e,t,r){r.d(t,{K:function(){return i}});var o=r(65654);class s{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this.setNotificationHandler(o.MH,e=>{let t=this._requestHandlerAbortControllers.get(e.params.requestId);null==t||t.abort(e.params.reason)}),this.setNotificationHandler(o.gD,e=>{this._onprogress(e)}),this.setRequestHandler(o.EO,e=>({}))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=e=>{this._onerror(e)},this._transport.onmessage=e=>{"method"in e?"id"in e?this._onrequest(e):this._onnotification(e):this._onresponse(e)},await this._transport.start()}_onclose(){var e;let t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,null===(e=this.onclose)||void 0===e||e.call(this);let r=new o.yp(o.jK.ConnectionClosed,"Connection closed");for(let e of t.values())e(r)}_onerror(e){var t;null===(t=this.onerror)||void 0===t||t.call(this,e)}_onnotification(e){var t;let r=null!==(t=this._notificationHandlers.get(e.method))&&void 0!==t?t:this.fallbackNotificationHandler;void 0!==r&&Promise.resolve().then(()=>r(e)).catch(e=>this._onerror(Error(`Uncaught error in notification handler: ${e}`)))}_onrequest(e){var t,r;let s=null!==(t=this._requestHandlers.get(e.method))&&void 0!==t?t:this.fallbackRequestHandler;if(void 0===s){null===(r=this._transport)||void 0===r||r.send({jsonrpc:"2.0",id:e.id,error:{code:o.jK.MethodNotFound,message:"Method not found"}}).catch(e=>this._onerror(Error(`Failed to send an error response: ${e}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i),Promise.resolve().then(()=>s(e,{signal:i.signal})).then(t=>{var r;if(!i.signal.aborted)return null===(r=this._transport)||void 0===r?void 0:r.send({result:t,jsonrpc:"2.0",id:e.id})},t=>{var r,s;if(!i.signal.aborted)return null===(r=this._transport)||void 0===r?void 0:r.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(t.code)?t.code:o.jK.InternalError,message:null!==(s=t.message)&&void 0!==s?s:"Internal error"}})}).catch(e=>this._onerror(Error(`Failed to send response: ${e}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:t,...r}=e.params,o=this._progressHandlers.get(Number(t));if(void 0===o){this._onerror(Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}o(r)}_onresponse(e){let t=e.id,r=this._responseHandlers.get(Number(t));if(void 0===r){this._onerror(Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(Number(t)),this._progressHandlers.delete(Number(t)),r("result"in e?e:new o.yp(e.error.code,e.error.message,e.error.data))}get transport(){return this._transport}async close(){var e;await (null===(e=this._transport)||void 0===e?void 0:e.close())}request(e,t,r){return new Promise((s,i)=>{var n,a,l,u;let c;if(!this._transport){i(Error("Not connected"));return}(null===(n=this._options)||void 0===n?void 0:n.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),null===(a=null==r?void 0:r.signal)||void 0===a||a.throwIfAborted();let d=this._requestMessageId++,p={...e,jsonrpc:"2.0",id:d};(null==r?void 0:r.onprogress)&&(this._progressHandlers.set(d,r.onprogress),p.params={...e.params,_meta:{progressToken:d}}),this._responseHandlers.set(d,e=>{var o;if(void 0!==c&&clearTimeout(c),null===(o=null==r?void 0:r.signal)||void 0===o||!o.aborted){if(e instanceof Error)return i(e);try{let r=t.parse(e.result);s(r)}catch(e){i(e)}}});let h=e=>{var t;this._responseHandlers.delete(d),this._progressHandlers.delete(d),null===(t=this._transport)||void 0===t||t.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:d,reason:String(e)}}).catch(e=>this._onerror(Error(`Failed to send cancellation: ${e}`))),i(e)};null===(l=null==r?void 0:r.signal)||void 0===l||l.addEventListener("abort",()=>{var e;void 0!==c&&clearTimeout(c),h(null===(e=null==r?void 0:r.signal)||void 0===e?void 0:e.reason)});let z=null!==(u=null==r?void 0:r.timeout)&&void 0!==u?u:6e4;c=setTimeout(()=>h(new o.yp(o.jK.RequestTimeout,"Request timed out",{timeout:z})),z),this._transport.send(p).catch(e=>{void 0!==c&&clearTimeout(c),i(e)})})}async notification(e){if(!this._transport)throw Error("Not connected");this.assertNotificationCapability(e.method);let t={...e,jsonrpc:"2.0"};await this._transport.send(t)}setRequestHandler(e,t){let r=e.shape.method.value;this.assertRequestHandlerCapability(r),this._requestHandlers.set(r,(r,o)=>Promise.resolve(t(e.parse(r),o)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,r=>Promise.resolve(t(e.parse(r))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}}class i extends s{constructor(e,t){var r;super(t),this._clientInfo=e,this._capabilities=null!==(r=null==t?void 0:t.capabilities)&&void 0!==r?r:{}}registerCapabilities(e){var t;if(this.transport)throw Error("Cannot register capabilities after connecting to transport");this._capabilities=(t=this._capabilities,Object.entries(e).reduce((e,[t,r])=>(r&&"object"==typeof r?e[t]=e[t]?{...e[t],...r}:r:e[t]=r,e),{...t}))}assertCapability(e,t){var r;if(!(null===(r=this._serverCapabilities)||void 0===r?void 0:r[e]))throw Error(`Server does not support ${e} (required for ${t})`)}async connect(e){await super.connect(e);try{let e=await this.request({method:"initialize",params:{protocolVersion:o.P7,capabilities:this._capabilities,clientInfo:this._clientInfo}},o.EE);if(void 0===e)throw Error(`Server sent invalid initialize result: ${e}`);if(!o.e5.includes(e.protocolVersion))throw Error(`Server's protocol version is not supported: ${e.protocolVersion}`);this._serverCapabilities=e.capabilities,this._serverVersion=e.serverInfo,this._instructions=e.instructions,await this.notification({method:"notifications/initialized"})}catch(e){throw this.close(),e}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var t,r,o,s,i;switch(e){case"logging/setLevel":if(!(null===(t=this._serverCapabilities)||void 0===t?void 0:t.logging))throw Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(null===(r=this._serverCapabilities)||void 0===r?void 0:r.prompts))throw Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(null===(o=this._serverCapabilities)||void 0===o?void 0:o.resources))throw Error(`Server does not support resources (required for ${e})`);if("resources/subscribe"===e&&!this._serverCapabilities.resources.subscribe)throw Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(null===(s=this._serverCapabilities)||void 0===s?void 0:s.tools))throw Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(null===(i=this._serverCapabilities)||void 0===i?void 0:i.prompts))throw Error(`Server does not support prompts (required for ${e})`)}}assertNotificationCapability(e){var t;if("notifications/roots/list_changed"===e&&!(null===(t=this._capabilities.roots)||void 0===t?void 0:t.listChanged))throw Error(`Client does not support roots list changed notifications (required for ${e})`)}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw Error(`Client does not support sampling capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw Error(`Client does not support roots capability (required for ${e})`)}}async ping(e){return this.request({method:"ping"},o.Zs,e)}async complete(e,t){return this.request({method:"completion/complete",params:e},o.Bi,t)}async setLoggingLevel(e,t){return this.request({method:"logging/setLevel",params:{level:e}},o.Zs,t)}async getPrompt(e,t){return this.request({method:"prompts/get",params:e},o.Go,t)}async listPrompts(e,t){return this.request({method:"prompts/list",params:e},o.ev,t)}async listResources(e,t){return this.request({method:"resources/list",params:e},o.Ol,t)}async listResourceTemplates(e,t){return this.request({method:"resources/templates/list",params:e},o.CD,t)}async readResource(e,t){return this.request({method:"resources/read",params:e},o.vg,t)}async subscribeResource(e,t){return this.request({method:"resources/subscribe",params:e},o.Zs,t)}async unsubscribeResource(e,t){return this.request({method:"resources/unsubscribe",params:e},o.Zs,t)}async callTool(e,t=o.GR,r){return this.request({method:"tools/call",params:e},t,r)}async listTools(e,t){return this.request({method:"tools/list",params:e},o.Gd,t)}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}},65654:function(e,t,r){r.d(t,{Bi:function(){return ej},CD:function(){return A},EE:function(){return w},EO:function(){return E},GR:function(){return el},Gd:function(){return ea},Go:function(){return eo},M$:function(){return eu},MH:function(){return x},Ol:function(){return O},P7:function(){return n},Zs:function(){return _},b5:function(){return ez},e5:function(){return a},ev:function(){return Q},gD:function(){return k},jK:function(){return s},kO:function(){return ev},vg:function(){return G},yp:function(){return eE}});var o,s,i=r(41270);let n="2024-11-05",a=[n,"2024-10-07"],l=i.z.union([i.z.string(),i.z.number().int()]),u=i.z.string(),c=i.z.object({_meta:i.z.optional(i.z.object({progressToken:i.z.optional(l)}).passthrough())}).passthrough(),d=i.z.object({method:i.z.string(),params:i.z.optional(c)}),p=i.z.object({_meta:i.z.optional(i.z.object({}).passthrough())}).passthrough(),h=i.z.object({method:i.z.string(),params:i.z.optional(p)}),z=i.z.object({_meta:i.z.optional(i.z.object({}).passthrough())}).passthrough(),g=i.z.union([i.z.string(),i.z.number().int()]),m=i.z.object({jsonrpc:i.z.literal("2.0"),id:g}).merge(d).strict(),b=i.z.object({jsonrpc:i.z.literal("2.0")}).merge(h).strict(),v=i.z.object({jsonrpc:i.z.literal("2.0"),id:g,result:z}).strict();(o=s||(s={}))[o.ConnectionClosed=-32e3]="ConnectionClosed",o[o.RequestTimeout=-32001]="RequestTimeout",o[o.ParseError=-32700]="ParseError",o[o.InvalidRequest=-32600]="InvalidRequest",o[o.MethodNotFound=-32601]="MethodNotFound",o[o.InvalidParams=-32602]="InvalidParams",o[o.InternalError=-32603]="InternalError";let f=i.z.object({jsonrpc:i.z.literal("2.0"),id:g,error:i.z.object({code:i.z.number().int(),message:i.z.string(),data:i.z.optional(i.z.unknown())})}).strict();i.z.union([m,b,v,f]);let _=z.strict(),x=h.extend({method:i.z.literal("notifications/cancelled"),params:p.extend({requestId:g,reason:i.z.string().optional()})}),y=i.z.object({name:i.z.string(),version:i.z.string()}).passthrough(),j=i.z.object({experimental:i.z.optional(i.z.object({}).passthrough()),sampling:i.z.optional(i.z.object({}).passthrough()),roots:i.z.optional(i.z.object({listChanged:i.z.optional(i.z.boolean())}).passthrough())}).passthrough(),q=d.extend({method:i.z.literal("initialize"),params:c.extend({protocolVersion:i.z.string(),capabilities:j,clientInfo:y})}),C=i.z.object({experimental:i.z.optional(i.z.object({}).passthrough()),logging:i.z.optional(i.z.object({}).passthrough()),prompts:i.z.optional(i.z.object({listChanged:i.z.optional(i.z.boolean())}).passthrough()),resources:i.z.optional(i.z.object({subscribe:i.z.optional(i.z.boolean()),listChanged:i.z.optional(i.z.boolean())}).passthrough()),tools:i.z.optional(i.z.object({listChanged:i.z.optional(i.z.boolean())}).passthrough())}).passthrough(),w=z.extend({protocolVersion:i.z.string(),capabilities:C,serverInfo:y,instructions:i.z.optional(i.z.string())}),H=h.extend({method:i.z.literal("notifications/initialized")}),E=d.extend({method:i.z.literal("ping")}),R=i.z.object({progress:i.z.number(),total:i.z.optional(i.z.number())}).passthrough(),k=h.extend({method:i.z.literal("notifications/progress"),params:p.merge(R).extend({progressToken:l})}),I=d.extend({params:c.extend({cursor:i.z.optional(u)}).optional()}),$=z.extend({nextCursor:i.z.optional(u)}),S=i.z.object({uri:i.z.string(),mimeType:i.z.optional(i.z.string())}).passthrough(),T=S.extend({text:i.z.string()}),M=S.extend({blob:i.z.string().base64()}),N=i.z.object({uri:i.z.string(),name:i.z.string(),description:i.z.optional(i.z.string()),mimeType:i.z.optional(i.z.string())}).passthrough(),P=i.z.object({uriTemplate:i.z.string(),name:i.z.string(),description:i.z.optional(i.z.string()),mimeType:i.z.optional(i.z.string())}).passthrough(),F=I.extend({method:i.z.literal("resources/list")}),O=$.extend({resources:i.z.array(N)}),V=I.extend({method:i.z.literal("resources/templates/list")}),A=$.extend({resourceTemplates:i.z.array(P)}),L=d.extend({method:i.z.literal("resources/read"),params:c.extend({uri:i.z.string()})}),G=z.extend({contents:i.z.array(i.z.union([T,M]))}),K=h.extend({method:i.z.literal("notifications/resources/list_changed")}),D=d.extend({method:i.z.literal("resources/subscribe"),params:c.extend({uri:i.z.string()})}),Z=d.extend({method:i.z.literal("resources/unsubscribe"),params:c.extend({uri:i.z.string()})}),B=h.extend({method:i.z.literal("notifications/resources/updated"),params:p.extend({uri:i.z.string()})}),J=i.z.object({name:i.z.string(),description:i.z.optional(i.z.string()),required:i.z.optional(i.z.boolean())}).passthrough(),U=i.z.object({name:i.z.string(),description:i.z.optional(i.z.string()),arguments:i.z.optional(i.z.array(J))}).passthrough(),W=I.extend({method:i.z.literal("prompts/list")}),Q=$.extend({prompts:i.z.array(U)}),X=d.extend({method:i.z.literal("prompts/get"),params:c.extend({name:i.z.string(),arguments:i.z.optional(i.z.record(i.z.string()))})}),Y=i.z.object({type:i.z.literal("text"),text:i.z.string()}).passthrough(),ee=i.z.object({type:i.z.literal("image"),data:i.z.string().base64(),mimeType:i.z.string()}).passthrough(),et=i.z.object({type:i.z.literal("resource"),resource:i.z.union([T,M])}).passthrough(),er=i.z.object({role:i.z.enum(["user","assistant"]),content:i.z.union([Y,ee,et])}).passthrough(),eo=z.extend({description:i.z.optional(i.z.string()),messages:i.z.array(er)}),es=h.extend({method:i.z.literal("notifications/prompts/list_changed")}),ei=i.z.object({name:i.z.string(),description:i.z.optional(i.z.string()),inputSchema:i.z.object({type:i.z.literal("object"),properties:i.z.optional(i.z.object({}).passthrough())}).passthrough()}).passthrough(),en=I.extend({method:i.z.literal("tools/list")}),ea=$.extend({tools:i.z.array(ei)}),el=z.extend({content:i.z.array(i.z.union([Y,ee,et])),isError:i.z.boolean().default(!1).optional()}),eu=el.or(z.extend({toolResult:i.z.unknown()})),ec=d.extend({method:i.z.literal("tools/call"),params:c.extend({name:i.z.string(),arguments:i.z.optional(i.z.record(i.z.unknown()))})}),ed=h.extend({method:i.z.literal("notifications/tools/list_changed")}),ep=i.z.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),eh=d.extend({method:i.z.literal("logging/setLevel"),params:c.extend({level:ep})}),ez=h.extend({method:i.z.literal("notifications/message"),params:p.extend({level:ep,logger:i.z.optional(i.z.string()),data:i.z.unknown()})}),eg=i.z.object({name:i.z.string().optional()}).passthrough(),em=i.z.object({hints:i.z.optional(i.z.array(eg)),costPriority:i.z.optional(i.z.number().min(0).max(1)),speedPriority:i.z.optional(i.z.number().min(0).max(1)),intelligencePriority:i.z.optional(i.z.number().min(0).max(1))}).passthrough(),eb=i.z.object({role:i.z.enum(["user","assistant"]),content:i.z.union([Y,ee])}).passthrough(),ev=d.extend({method:i.z.literal("sampling/createMessage"),params:c.extend({messages:i.z.array(eb),systemPrompt:i.z.optional(i.z.string()),includeContext:i.z.optional(i.z.enum(["none","thisServer","allServers"])),temperature:i.z.optional(i.z.number()),maxTokens:i.z.number().int(),stopSequences:i.z.optional(i.z.array(i.z.string())),metadata:i.z.optional(i.z.object({}).passthrough()),modelPreferences:i.z.optional(em)})}),ef=z.extend({model:i.z.string(),stopReason:i.z.optional(i.z.enum(["endTurn","stopSequence","maxTokens"]).or(i.z.string())),role:i.z.enum(["user","assistant"]),content:i.z.discriminatedUnion("type",[Y,ee])}),e_=i.z.object({type:i.z.literal("ref/resource"),uri:i.z.string()}).passthrough(),ex=i.z.object({type:i.z.literal("ref/prompt"),name:i.z.string()}).passthrough(),ey=d.extend({method:i.z.literal("completion/complete"),params:c.extend({ref:i.z.union([ex,e_]),argument:i.z.object({name:i.z.string(),value:i.z.string()}).passthrough()})}),ej=z.extend({completion:i.z.object({values:i.z.array(i.z.string()).max(100),total:i.z.optional(i.z.number().int()),hasMore:i.z.optional(i.z.boolean())}).passthrough()}),eq=i.z.object({uri:i.z.string().startsWith("file://"),name:i.z.optional(i.z.string())}).passthrough(),eC=d.extend({method:i.z.literal("roots/list")}),ew=z.extend({roots:i.z.array(eq)}),eH=h.extend({method:i.z.literal("notifications/roots/list_changed")});i.z.union([E,q,ey,eh,X,W,F,V,L,D,Z,ec,en]),i.z.union([x,k,H,eH]),i.z.union([_,ef,ew]),i.z.union([E,ev,eC]),i.z.union([x,k,ez,B,K,ed,es]),i.z.union([_,w,ej,eo,Q,O,A,G,el,ea]);class eE extends Error{constructor(e,t,r){super(`MCP error ${e}: ${t}`),this.code=e,this.data=r}}}}]);